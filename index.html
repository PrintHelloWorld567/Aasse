<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Voice Wordle Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
    margin:0;
    font-family: Arial, sans-serif;
    background:#111;
    color:white;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
    height:100vh;
    text-align:center;
}

#header {
    font-size: 48px;
    margin-top: 20px;
    color:#ffdd00;
    text-shadow: 0 0 10px #ffdd00, 0 0 20px #ffdd00;
}

#wordDisplay {
    font-size: 64px;
    margin: 20px;
    letter-spacing: 10px;
    color:#00ff88;
    text-shadow:0 0 15px #00ff88;
}

#timerBar {
    width:80%;
    height:20px;
    background:#333;
    border-radius:10px;
    overflow:hidden;
    margin: 20px 0;
}

#timerFill {
    width:100%;
    height:100%;
    background:#ff4444;
    transition: width 1s linear;
}

#guesses {
    font-size: 24px;
    margin: 10px 0;
    max-height: 200px;
    overflow-y:auto;
    width: 80%;
    text-align:left;
    padding:10px;
    background: rgba(255,255,255,0.05);
    border-radius: 10px;
}

#status {
    font-size: 32px;
    margin:10px 0;
    color:#00aaff;
}

#startBtn {
    font-size:28px;
    padding:15px 40px;
    background:#ffdd00;
    color:black;
    border:none;
    border-radius:15px;
    cursor:pointer;
    margin:20px;
    text-shadow:0 0 5px #000;
}

.correct {
    color:#00ff88;
    font-weight:bold;
}
</style>
</head>
<body>

<div id="header">ðŸŽ¤ Voice Wordle!</div>
<div id="wordDisplay">A _ _ _ _</div>

<div id="timerBar"><div id="timerFill"></div></div>

<div id="status">Tap START</div>
<div id="guesses"></div>

<button id="startBtn">START ROUND</button>

<script>
// --- Word list (5-letter words) ---
const words = [
"apple","brave","crane","dance","eagle","flame","glove","honey","ivory","jelly",
"knife","lemon","mango","novel","ocean","piano","queen","raven","snake","tiger",
"ultra","vivid","whale","xenon","yacht","zebra"
];

// Game state
let currentWord = "";
let revealedFirstLetter = "";
let guesses = [];
let recognition;
let listening = false;
let timer = 30;
let timerInterval;

// DOM elements
const wordDisplay = document.getElementById("wordDisplay");
const status = document.getElementById("status");
const guessesDiv = document.getElementById("guesses");
const startBtn = document.getElementById("startBtn");
const timerFill = document.getElementById("timerFill");

// Start new round
startBtn.onclick = async () => {
    startBtn.style.display = "none";
    guesses = [];
    guessesDiv.innerHTML = "";
    timer = 30;
    updateTimerBar();

    // Pick a new word
    currentWord = words[Math.floor(Math.random()*words.length)];
    revealedFirstLetter = currentWord[0].toUpperCase();
    wordDisplay.textContent = revealedFirstLetter + " _ _ _ _";
    status.textContent = "Listening...";

    // Timer countdown
    clearInterval(timerInterval);
    timerInterval = setInterval(()=>{
        timer--;
        updateTimerBar();
        if(timer <= 0){
            clearInterval(timerInterval);
            status.textContent = "Time's up! Word was: " + currentWord.toUpperCase();
            startBtn.style.display = "inline-block";
        }
    },1000);

    // Ask for mic
    try{
        await navigator.mediaDevices.getUserMedia({audio:true});
    } catch(e){
        alert("Please allow microphone access.");
        return;
    }

    // Speech recognition
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if(!SpeechRecognition){
        alert("Speech recognition not supported. Use Chrome.");
        return;
    }

    recognition = new SpeechRecognition();
    recognition.continuous = true;
    recognition.interimResults = true;
    recognition.lang = "en-US";

    recognition.onstart = () => { listening=true; }
    recognition.onresult = (event) => {
        const text = event.results[event.results.length-1][0].transcript.toLowerCase().trim();
        const cleaned = text.replace(/[^a-z]/gi,"");

        if(cleaned.length===5 && !guesses.includes(cleaned) && cleaned[0].toLowerCase()!==revealedFirstLetter.toLowerCase()){
            guesses.push(cleaned);
            const guessElem = document.createElement("div");
            guessElem.textContent = cleaned.toUpperCase();
            if(cleaned===currentWord) guessElem.classList.add("correct");
            guessesDiv.appendChild(guessElem);

            if(cleaned===currentWord){
                status.textContent = "ðŸŽ‰ CORRECT! ðŸŽ‰";
                clearInterval(timerInterval);
                startBtn.style.display = "inline-block";
            }
        }
    };

    recognition.onerror = () => { restartRecognition(); }
    recognition.onend = () => { restartRecognition(); }

    recognition.start();
}

function restartRecognition(){
    if(recognition && listening){
        try{ recognition.start(); } catch(e){}
    }
}

function updateTimerBar(){
    timerFill.style.width = (timer/30*100)+"%";
}
</script>

</body>
</html>
